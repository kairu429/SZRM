<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚µã‚¤ã‚¼ãƒªãƒ¤æ³¨æ–‡ã‚¹ãƒ­ãƒƒãƒˆ - ãƒ‡ãƒ¼ã‚¿å¼•ãç¶™ãç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@700;800;900&display=swap');
        
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            background-color: #f7fafc;
            color: #2d3748;
            overflow-x: hidden;
        }

        .saize-card {
            background: white;
            border: 6px solid #009241;
            border-radius: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .slot-window {
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff;
            border: 4px inset #edf2f7;
            margin: 15px 0;
            overflow: hidden;
            border-radius: 20px;
        }

        .spinning {
            animation: slot-spin 0.07s linear infinite;
        }

        @keyframes slot-spin {
            0% { transform: translateY(-20px); opacity: 0.3; }
            100% { transform: translateY(20px); opacity: 0.3; }
        }

        /* è™¹è‰²ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒ¬ã‚¢ãƒˆãƒ­ãƒ•ã‚£ãƒ¼ç”¨ï¼‰ */
        @keyframes rainbow-bg {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .rainbow-rank {
            background: linear-gradient(124deg, #ff2400, #e81d1d, #e8b71d, #e3e81d, #1de840, #1ddde8, #2b1de8, #dd00f3, #dd00f3);
            background-size: 800% 800%;
            animation: rainbow-bg 4s ease infinite;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900;
        }

        .rainbow-border {
            background: linear-gradient(124deg, #ff2400, #e81d1d, #e8b71d, #e3e81d, #1de840, #1ddde8, #2b1de8, #dd00f3, #dd00f3);
            background-size: 400% 400%;
            animation: rainbow-bg 2s ease infinite;
            border: 4px solid transparent !important;
        }

        .btn-saize {
            background: linear-gradient(to bottom, #00b34d, #008037);
            box-shadow: 0 6px 0 #005a26;
            transition: all 0.1s ease;
        }
        .btn-saize:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #005a26;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 100;
            align-items: center; justify-content: center;
            backdrop-filter: blur(8px);
        }

        .custom-scroll::-webkit-scrollbar { width: 5px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e0; border-radius: 10px; }

        #notify {
            position: fixed;
            top: -100px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 350px;
            background: white; border-radius: 20px; padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: top 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 1000;
        }
        #notify.show { top: 20px; }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <!-- ç§°å·é€šçŸ¥ -->
    <div id="notify" class="flex items-center">
        <div id="notify-icon" class="text-4xl mr-4">ğŸ†</div>
        <div>
            <div class="text-[10px] font-black text-green-600 tracking-tighter uppercase">ç§°å·ç²å¾—ï¼</div>
            <div id="notify-title" class="text-sm font-black">ã‚¿ã‚¤ãƒˆãƒ«</div>
        </div>
    </div>

    <div class="max-w-md w-full text-center">
        <header class="mb-8">
            <h1 class="text-4xl font-black text-red-600 drop-shadow-sm">ã‚µã‚¤ã‚¼ãƒªãƒ¤<span class="text-green-600">ã‚¬ãƒãƒ£</span></h1>
        </header>

        <div class="saize-card p-6 mb-6 relative">
            <div class="flex justify-between items-center mb-2">
                <span id="cat-label" class="bg-green-100 text-green-700 text-[10px] px-3 py-1 rounded-full font-black">CATEGORY</span>
                <button id="age-btn" class="bg-gray-800 text-white text-[10px] px-3 py-1 rounded-full font-black hover:bg-black">
                    å¹´é½¢: <span id="age-val">--</span>æ­³ âœï¸
                </button>
            </div>

            <div class="slot-window">
                <div id="menu-name" class="text-2xl font-black px-2 leading-tight">ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</div>
            </div>

            <div class="flex justify-between items-end mt-4">
                <div class="text-left">
                    <div class="text-[10px] text-gray-400 font-bold">Menu No.</div>
                    <div id="menu-id" class="text-xl font-black text-green-600">----</div>
                </div>
                <div class="text-right">
                    <div class="text-[10px] text-gray-400 font-bold">Price</div>
                    <div id="menu-price" class="text-3xl font-black text-red-600">Â¥ ---</div>
                </div>
            </div>
        </div>

        <button id="spin-btn" class="btn-saize w-full py-5 rounded-2xl text-white text-2xl font-black mb-6">
            æ³¨æ–‡ã‚’æ±ºã‚ã‚‹ï¼
        </button>

        <div class="grid grid-cols-2 gap-4 text-xs font-black text-gray-500">
            <div class="bg-white p-2 rounded-xl border shadow-sm">ç™ºè¦‹: <span id="stat-collected">0</span></div>
            <div class="bg-white p-2 rounded-xl border shadow-sm">å›æ•°: <span id="stat-spins">0</span></div>
        </div>
    </div>

    <!-- ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ -->
    <div class="fixed bottom-6 w-full max-w-md px-6 flex justify-between items-center pointer-events-none">
        <button id="open-admin" class="pointer-events-auto w-14 h-14 bg-gray-900 text-white rounded-2xl shadow-xl flex items-center justify-center text-2xl hover:scale-110 transition-all" title="ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ">âš™ï¸</button>
        <button id="open-book" class="pointer-events-auto w-18 h-18 bg-white border-4 border-green-600 rounded-3xl shadow-xl flex items-center justify-center text-4xl p-4 hover:scale-110 transition-all">ğŸ“–</button>
    </div>

    <!-- å¹´é½¢è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="age-modal" class="modal-overlay">
        <div class="bg-white p-8 rounded-[40px] w-full max-w-xs text-center shadow-2xl">
            <div class="text-6xl mb-4">ğŸ</div>
            <h2 class="text-2xl font-black mb-2">ä½•æ­³ã§ã™ã‹ï¼Ÿ</h2>
            <p class="text-[10px] font-bold text-gray-400 mb-6 uppercase tracking-widest">Age Verification</p>
            <input type="number" id="age-input" class="w-full text-center text-4xl font-black border-b-4 border-gray-100 focus:border-green-500 outline-none mb-8" placeholder="20">
            <button id="age-save" class="w-full bg-green-600 text-white font-black py-4 rounded-2xl text-xl hover:bg-green-700 transition-all">æ±ºå®š</button>
        </div>
    </div>

    <!-- å›³é‘‘ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="book-modal" class="modal-overlay">
        <div class="bg-white w-full max-w-lg rounded-[40px] overflow-hidden flex flex-col h-[85vh] shadow-2xl">
            <div class="bg-green-600 p-4 flex justify-around items-center">
                <button id="tab-menu" class="text-white font-black text-sm px-4 py-2 bg-white/20 rounded-full">ãƒ¡ãƒ‹ãƒ¥ãƒ¼å›³é‘‘</button>
                <button id="tab-trophy" class="text-white font-black text-sm px-4 py-2 opacity-60 rounded-full">ç§°å·ãƒˆãƒ­ãƒ•ã‚£ãƒ¼</button>
                <button class="close-btn text-white text-3xl font-light">&times;</button>
            </div>
            
            <div id="content-menu" class="flex-1 overflow-y-auto p-6 custom-scroll">
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-xs font-black text-gray-400">PROGRESS</span>
                        <span id="prog-text" class="text-sm font-black text-green-700">0/0</span>
                    </div>
                    <div class="w-full h-4 bg-gray-100 rounded-full overflow-hidden">
                        <div id="prog-bar" class="h-full bg-green-500 transition-all duration-1000"></div>
                    </div>
                </div>
                <div id="menu-list" class="space-y-3"></div>
            </div>

            <div id="content-trophy" class="hidden flex-1 overflow-y-auto p-6 custom-scroll bg-gray-50">
                <div id="trophy-list" class="space-y-4"></div>
            </div>
        </div>
    </div>

    <script>
        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒã‚¹ã‚¿
        const MENU_MASTER = [
            { id: "1202", name: "å°ã‚¨ãƒ“ã®ã‚µãƒ©ãƒ€", price: 350, cat: "ã‚µãƒ©ãƒ€" },
            { id: "1205", name: "ã‚ã‹ã‚ã®ã‚µãƒ©ãƒ€", price: 350, cat: "ã‚µãƒ©ãƒ€" },
            { id: "1207", name: "ãƒ¢ãƒƒãƒ„ã‚¡ãƒ¬ãƒ©ã®ã‚µãƒ©ãƒ€", price: 400, cat: "ã‚µãƒ©ãƒ€" },
            { id: "1208", name: "ã‚°ãƒªãƒ¼ãƒ³ã‚µãƒ©ãƒ€", price: 350, cat: "ã‚µãƒ©ãƒ€" },
            { id: "1209", name: "ãƒã‚­ãƒ³ã®ã‚µãƒ©ãƒ€", price: 350, cat: "ã‚µãƒ©ãƒ€" },
            { id: "1301", name: "ã‚³ãƒ¼ãƒ³ã‚¯ãƒªãƒ¼ãƒ ã‚¹ãƒ¼ãƒ—", price: 150, cat: "ã‚¹ãƒ¼ãƒ—" },
            { id: "1305", name: "ç”°èˆé¢¨ãƒŸãƒã‚¹ãƒˆãƒ­ãƒ¼ãƒ", price: 300, cat: "ã‚¹ãƒ¼ãƒ—" },
            { id: "1307", name: "ãŸã¾ã­ãã®ã‚ºãƒƒãƒ‘", price: 300, cat: "ã‚¹ãƒ¼ãƒ—" },
            { id: "1401", name: "è¾›å‘³ãƒã‚­ãƒ³", price: 300, cat: "å‰èœ" },
            { id: "1402", name: "ã‚¢ãƒ­ã‚¹ãƒ†ã‚£ãƒãƒ¼ãƒ‹", price: 400, cat: "å‰èœ" },
            { id: "1403", name: "ã»ã†ã‚Œã‚“è‰ã®ã‚½ãƒ†ãƒ¼", price: 200, cat: "å‰èœ" },
            { id: "1404", name: "ãƒãƒƒãƒ—ã‚³ãƒ¼ãƒ³ã‚·ãƒ¥ãƒªãƒ³ãƒ—", price: 300, cat: "å‰èœ" },
            { id: "1405", name: "ã‚¨ã‚¹ã‚«ãƒ«ã‚´ã®ã‚ªãƒ¼ãƒ–ãƒ³ç„¼ã", price: 400, cat: "å‰èœ" },
            { id: "1406", name: "å°ã‚¨ãƒ“ã®ã‚«ã‚«ã‚¯ãƒ†ãƒ«", price: 280, cat: "å‰èœ" },
            { id: "1410", name: "ãƒ ãƒ¼ãƒ«è²ã®ã‚¬ãƒ¼ãƒªãƒƒã‚¯ç„¼ã", price: 400, cat: "å‰èœ" },
            { id: "1415", name: "ã‚«ãƒªãƒƒã¨ãƒãƒ†ãƒˆ", price: 250, cat: "å‰èœ" },
            { id: "1425", name: "æŸ”ã‚‰ã‹é’è±†ã®æ¸©ã‚µãƒ©ãƒ€", price: 200, cat: "å‰èœ" },
            { id: "2101", name: "ãƒŸãƒ©ãƒé¢¨ãƒ‰ãƒªã‚¢", price: 300, cat: "ãƒ‰ãƒªã‚¢" },
            { id: "2103", name: "åŠç†Ÿåµã®ãƒŸãƒ©ãƒé¢¨ãƒ‰ãƒªã‚¢", price: 350, cat: "ãƒ‰ãƒªã‚¢" },
            { id: "2106", name: "ã‚¿ãƒ©ã‚³ã¨ã‚¨ãƒ“ã®ãƒ‰ãƒªã‚¢", price: 400, cat: "ãƒ‰ãƒªã‚¢" },
            { id: "2203", name: "ãƒãƒ«ã‚²ãƒªãƒ¼ã‚¿ãƒ”ã‚¶", price: 400, cat: "ãƒ”ã‚¶" },
            { id: "2206", name: "ãŸã£ã·ã‚Šã‚³ãƒ¼ãƒ³ã®ãƒ”ã‚¶", price: 400, cat: "ãƒ”ã‚¶" },
            { id: "2301", name: "ã‚¿ãƒ©ã‚³ã‚½ãƒ¼ã‚¹ã‚·ã‚·ãƒªãƒ¼é¢¨", price: 400, cat: "ãƒ‘ã‚¹ã‚¿" },
            { id: "2303", name: "ãƒšãƒšãƒ­ãƒ³ãƒãƒ¼ãƒ", price: 300, cat: "ãƒ‘ã‚¹ã‚¿" },
            { id: "2304", name: "ãƒ‘ãƒ«ãƒé¢¨ã‚¹ãƒ‘ã‚²ãƒƒãƒ†ã‚£", price: 400, cat: "ãƒ‘ã‚¹ã‚¿" },
            { id: "2305", name: "ã‚«ãƒ«ãƒœãƒŠãƒ¼ãƒ©", price: 500, cat: "ãƒ‘ã‚¹ã‚¿" },
            { id: "2306", name: "ãƒŸãƒ¼ãƒˆã‚½ãƒ¼ã‚¹ãƒœãƒ­ãƒ‹ã‚¢é¢¨", price: 400, cat: "ãƒ‘ã‚¹ã‚¿" },
            { id: "2310", name: "ã‚¹ãƒ¼ãƒ—å…¥ã‚Šå¡©å‘³ãƒœãƒ³ã‚´ãƒ¬", price: 500, cat: "ãƒ‘ã‚¹ã‚¿" },
            { id: "2328", name: "ã‚¤ã‚«ã®å¢¨å…¥ã‚Šã‚»ãƒ”ã‚¢ã‚½ãƒ¼ã‚¹", price: 500, cat: "ãƒ‘ã‚¹ã‚¿" },
            { id: "2402", name: "è‹¥é¶ã®ãƒ‡ã‚£ã‚¢ãƒœãƒ©é¢¨", price: 500, cat: "è‚‰æ–™ç†" },
            { id: "2403", name: "ã‚¤ã‚¿ãƒªã‚¢ãƒ³ãƒãƒ³ãƒãƒ¼ã‚°", price: 500, cat: "è‚‰æ–™ç†" },
            { id: "2407", name: "ãƒ‡ã‚£ã‚¢ãƒœãƒ©é¢¨ãƒãƒ³ãƒãƒ¼ã‚°", price: 500, cat: "è‚‰æ–™ç†" },
            { id: "2418", name: "ãƒŸãƒƒã‚¯ã‚¹ã‚°ãƒªãƒ«", price: 650, cat: "è‚‰æ–™ç†" },
            { id: "3201", name: "ãƒ†ã‚£ãƒ©ãƒŸã‚¹ã‚¯ãƒ©ã‚·ã‚³", price: 300, cat: "ãƒ‡ã‚¶ãƒ¼ãƒˆ" },
            { id: "3206", name: "ã‚¤ã‚¿ãƒªã‚¢ãƒ³ãƒ—ãƒªãƒ³", price: 250, cat: "ãƒ‡ã‚¶ãƒ¼ãƒˆ" },
            { id: "3301", name: "ç”Ÿãƒ“ãƒ¼ãƒ«(ã‚¸ãƒ§ãƒƒã‚­)", price: 400, cat: "ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«" },
            { id: "3306", name: "ã‚°ãƒ©ãƒƒãƒ‘", price: 300, cat: "ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«" },
            { id: "3401", name: "ã‚°ãƒ©ã‚¹ãƒ¯ã‚¤ãƒ³(èµ¤)", price: 100, cat: "ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«" },
            { id: "5101", name: "ã‚»ãƒƒãƒˆãƒ‰ãƒªãƒ³ã‚¯ãƒãƒ¼", price: 200, cat: "ãƒ‰ãƒªãƒ³ã‚¯" }
        ];

        // ç§°å·ãƒ‡ãƒ¼ã‚¿ï¼ˆæ¡ä»¶ã¨åå‰ã‚’è¡¨ç¤ºï¼‰
        const TROPHIES = Array.from({length: 100}, (_, i) => {
            const id = i + 1;
            if (id === 1) return { id, name: "ã¯ã˜ã‚ã¦ã®å®¢", condition: "1å›æ³¨æ–‡ã™ã‚‹", check: s => s.spins >= 1, icon: "ğŸ‘¤" };
            if (id === 2) return { id, name: "ã‚µãƒ©ãƒ€é€š", condition: "ã‚µãƒ©ãƒ€ã‚’3ç¨®é¡ç™ºè¦‹", check: s => s.collected.filter(mid => MENU_MASTER.find(m => m.id === mid)?.cat === "ã‚µãƒ©ãƒ€").length >= 3, icon: "ğŸ¥—" };
            if (id === 3) return { id, name: "ãƒ‘ã‚¹ã‚¿æ„›å¥½å®¶", condition: "ãƒ‘ã‚¹ã‚¿ã‚’5ç¨®é¡ç™ºè¦‹", check: s => s.collected.filter(mid => MENU_MASTER.find(m => m.id === mid)?.cat === "ãƒ‘ã‚¹ã‚¿").length >= 5, icon: "ğŸ" };
            if (id === 10) return { id, name: "å¸¸é€£ã•ã‚“", condition: "ç´¯è¨ˆ30å›ä»¥ä¸Šæ³¨æ–‡", check: s => s.spins >= 30, icon: "ğŸ«" };
            if (id === 50) return { id, name: "ã‚µã‚¤ã‚¼è²´æ—", condition: "ç´¯è¨ˆé‡‘é¡1ä¸‡å††ã‚’çªç ´", check: s => s.totalPrice >= 10000, icon: "ğŸ’" };
            if (id === 100) return { id, name: "ã•ã„ãœã‚Šã‚ã®ç‹æ§˜", condition: "å…¨ã¦ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆ", check: s => {
                const active = s.age < 20 ? MENU_MASTER.filter(m => m.cat !== "ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«") : MENU_MASTER;
                return active.length > 0 && active.every(m => s.collected.includes(m.id));
            }, icon: "ğŸ‘‘", isRainbow: true };
            
            return {
                id,
                name: `ç†Ÿç·´ã®å®¢ Lv.${id}`,
                condition: `ç´¯è¨ˆæ³¨æ–‡å›æ•° ${id * 2}å›`,
                check: s => s.spins >= id * 2,
                icon: "ğŸ–ï¸"
            };
        });

        // çŠ¶æ…‹ç®¡ç†ï¼ˆlocalStorageã‹ã‚‰ã®èª­ã¿è¾¼ã¿ï¼‰
        const state = {
            age: JSON.parse(localStorage.getItem('sz_age')) || null,
            spins: JSON.parse(localStorage.getItem('sz_spins')) || 0,
            collected: JSON.parse(localStorage.getItem('sz_collected')) || [],
            totalPrice: JSON.parse(localStorage.getItem('sz_total_price')) || 0,
            unlockedTrophies: JSON.parse(localStorage.getItem('sz_unlocked_t')) || []
        };

        // ã‚»ãƒ¼ãƒ–å‡¦ç†
        const save = () => {
            localStorage.setItem('sz_age', JSON.stringify(state.age));
            localStorage.setItem('sz_spins', JSON.stringify(state.spins));
            localStorage.setItem('sz_collected', JSON.stringify(state.collected));
            localStorage.setItem('sz_total_price', JSON.stringify(state.totalPrice));
            localStorage.setItem('sz_unlocked_t', JSON.stringify(state.unlockedTrophies));
        };

        const updateStats = () => {
            document.getElementById('stat-collected').innerText = state.collected.length;
            document.getElementById('stat-spins').innerText = state.spins;
            document.getElementById('age-val').innerText = state.age || "--";
        };

        const showNotify = (trophy) => {
            const n = document.getElementById('notify');
            document.getElementById('notify-title').innerText = trophy.name;
            document.getElementById('notify-icon').innerText = trophy.icon;
            n.classList.add('show');
            setTimeout(() => n.classList.remove('show'), 4000);
        };

        const checkTrophies = () => {
            TROPHIES.forEach(t => {
                if (!state.unlockedTrophies.includes(t.id) && t.check(state)) {
                    state.unlockedTrophies.push(t.id);
                    showNotify(t);
                    save();
                }
            });
        };

        const spin = () => {
            if (!state.age) {
                document.getElementById('age-modal').style.display = 'flex';
                return;
            }
            
            const btn = document.getElementById('spin-btn');
            const display = document.getElementById('menu-name');
            btn.disabled = true;
            display.classList.add('spinning');

            const pool = state.age < 20 ? MENU_MASTER.filter(m => m.cat !== "ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«") : MENU_MASTER;

            let count = 0;
            const iv = setInterval(() => {
                display.innerText = pool[Math.floor(Math.random() * pool.length)].name;
                if (++count > 25) {
                    clearInterval(iv);
                    display.classList.remove('spinning');
                    
                    const result = pool[Math.floor(Math.random() * pool.length)];
                    display.innerText = result.name;
                    document.getElementById('menu-id').innerText = result.id;
                    document.getElementById('menu-price').innerText = "Â¥ " + result.price;
                    document.getElementById('cat-label').innerText = result.cat;

                    if (!state.collected.includes(result.id)) state.collected.push(result.id);
                    state.spins++;
                    state.totalPrice += result.price;
                    
                    save();
                    updateStats();
                    checkTrophies();
                    btn.disabled = false;
                }
            }, 60);
        };

        const renderBook = () => {
            const list = document.getElementById('menu-list');
            list.innerHTML = '';
            const pool = state.age < 20 ? MENU_MASTER.filter(m => m.cat !== "ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«") : MENU_MASTER;

            pool.forEach(m => {
                const isFound = state.collected.includes(m.id);
                const item = document.createElement('div');
                item.className = `p-4 rounded-2xl border-2 flex justify-between items-center transition-all ${isFound ? 'bg-white border-green-200 shadow-sm' : 'bg-gray-100 opacity-40 grayscale'}`;
                item.innerHTML = `
                    <div class="flex items-center">
                        <span class="text-[9px] font-black text-gray-300 mr-3">#${m.id}</span>
                        <div>
                            <div class="text-[8px] text-green-600 font-black uppercase">${m.cat}</div>
                            <div class="text-sm font-black text-gray-800">${isFound ? m.name : 'ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ'}</div>
                        </div>
                    </div>
                    <div class="text-red-500 font-black">${isFound ? 'Â¥'+m.price : '---'}</div>
                `;
                list.appendChild(item);
            });

            document.getElementById('prog-text').innerText = `${state.collected.length} / ${pool.length}`;
            document.getElementById('prog-bar').style.width = (state.collected.length / pool.length * 100) + '%';
        };

        const renderTrophy = () => {
            const list = document.getElementById('trophy-list');
            list.innerHTML = '';
            TROPHIES.forEach(t => {
                const isUnlocked = state.unlockedTrophies.includes(t.id);
                const card = document.createElement('div');
                
                const rainbowClass = (t.isRainbow && isUnlocked) ? 'rainbow-border' : '';
                const nameClass = (t.isRainbow && isUnlocked) ? 'rainbow-rank' : (isUnlocked ? 'text-gray-800' : 'text-gray-400');

                card.className = `p-5 rounded-3xl border-2 flex items-center transition-all ${isUnlocked ? 'bg-white border-yellow-200 shadow-sm' : 'bg-gray-50 border-gray-100'} ${rainbowClass}`;
                card.innerHTML = `
                    <div class="text-4xl mr-5 flex-shrink-0">${isUnlocked ? t.icon : 'ğŸ”’'}</div>
                    <div class="flex-1">
                        <div class="text-[8px] font-black text-gray-400 uppercase">Achievement No.${t.id}</div>
                        <div class="text-sm font-black ${nameClass}">${t.name}</div>
                        <div class="text-[10px] font-bold text-gray-500 mt-1">æ¡ä»¶: ${t.condition}</div>
                        ${isUnlocked ? '<div class="text-[9px] text-green-600 font-black mt-1">â˜… ç²å¾—æ¸ˆã¿</div>' : ''}
                    </div>
                `;
                list.appendChild(card);
            });
        };

        // UIã‚¤ãƒ™ãƒ³ãƒˆ
        document.getElementById('spin-btn').onclick = spin;
        document.getElementById('age-btn').onclick = () => document.getElementById('age-modal').style.display = 'flex';
        document.getElementById('age-save').onclick = () => {
            const val = parseInt(document.getElementById('age-input').value);
            if (val > 0) {
                state.age = val;
                save();
                updateStats();
                document.getElementById('age-modal').style.display = 'none';
            }
        };

        document.getElementById('open-book').onclick = () => {
            document.getElementById('book-modal').style.display = 'flex';
            renderBook();
        };

        document.getElementById('tab-menu').onclick = () => {
            document.getElementById('content-menu').classList.remove('hidden');
            document.getElementById('content-trophy').classList.add('hidden');
            document.getElementById('tab-menu').classList.replace('opacity-60', 'bg-white/20');
            document.getElementById('tab-trophy').classList.replace('bg-white/20', 'opacity-60');
        };

        document.getElementById('tab-trophy').onclick = () => {
            document.getElementById('content-menu').classList.add('hidden');
            document.getElementById('content-trophy').classList.remove('hidden');
            document.getElementById('tab-trophy').classList.replace('opacity-60', 'bg-white/20');
            document.getElementById('tab-menu').classList.replace('bg-white/20', 'opacity-60');
            renderTrophy();
        };

        document.querySelectorAll('.close-btn').forEach(b => b.onclick = () => {
            document.querySelectorAll('.modal-overlay').forEach(m => m.style.display = 'none');
        });

        document.getElementById('open-admin').onclick = () => {
            if(confirm("å…¨ã¦ã®é€²è¡Œãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ")) {
                localStorage.clear();
                location.reload();
            }
        };

        // åˆæœŸå®Ÿè¡Œ
        updateStats();
        if (!state.age) {
            document.getElementById('age-modal').style.display = 'flex';
        }
    </script>
</body>
</html>
